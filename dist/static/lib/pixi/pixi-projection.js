var pixi_projection,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(t){var e=function(){function t(t,e){void 0===e&&(e=!0),this._enabled=!1,this.legacy=t,e&&(this.enabled=!0),this.legacy.proj=this}return Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t},enumerable:!0,configurable:!0}),t.prototype.clear=function(){},t}();t.Projection=e}(pixi_projection||(pixi_projection={})),function(t){var e,r;e=t.webgl||(t.webgl={}),r=function(){function t(t){this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null},t}(),e.BatchBuffer=r}(pixi_projection||(pixi_projection={})),function(t){(t.webgl||(t.webgl={})).generateMultiTextureShader=function(t,e,r,i){e=(e=e.replace(/%count%/gi,i+"")).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(textureId == "+r+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], textureCoord);",e+="\n}";return(e+="\n")+"\n"}(i));for(var n=new PIXI.Shader(r,t,e),o=new Int32Array(i),a=0;a<i;a++)o[a]=a;return n.bind(),n.uniforms.uSamplers=o,n}}(pixi_projection||(pixi_projection={})),function(t){!function(e){var r=PIXI.ObjectRenderer,i=PIXI.settings,n=PIXI.glCore.GLBuffer,o=PIXI.utils.premultiplyTint,a=PIXI.utils.premultiplyBlendMode,s=0,u=function(){this.textures=[],this.textureCount=0,this.ids=[],this.size=0,this.start=0,this.blend=PIXI.BLEND_MODES.NORMAL,this.uniforms=null};e.BatchGroup=u;var c=function(r){function c(e){var n=r.call(this,e)||this;n.shaderVert="",n.shaderFrag="",n.MAX_TEXTURES_LOCAL=32,n.vertSize=5,n.vertByteSize=4*n.vertSize,n.size=i.SPRITE_BATCH_SIZE,n.currentIndex=0,n.sprites=[],n.vertexBuffers=[],n.vaos=[],n.vaoMax=2,n.vertexCount=0,n.MAX_TEXTURES=1,n.indices=t.utils.createIndicesForQuads(n.size),n.groups=[];for(var o=0;o<n.size;o++)n.groups[o]=new u;return n.vaoMax=2,n.vertexCount=0,n.renderer.on("prerender",n.onPrerender,n),n}return __extends(c,r),c.prototype.getUniforms=function(t){return null},c.prototype.syncUniforms=function(t){if(t){var e=this.shader;for(var r in t)e.uniforms[r]=t[r]}},c.prototype.onContextChange=function(){var r=this.renderer.gl;this.MAX_TEXTURES=Math.min(this.MAX_TEXTURES_LOCAL,this.renderer.plugins.sprite.MAX_TEXTURES),this.shader=e.generateMultiTextureShader(this.shaderVert,this.shaderFrag,r,this.MAX_TEXTURES),this.indexBuffer=n.createIndexBuffer(r,this.indices,r.STATIC_DRAW),this.renderer.bindVao(null),this.shader.attributes;for(var i=0;i<this.vaoMax;i++){var o=this.vertexBuffers[i]=n.createVertexBuffer(r,null,r.STREAM_DRAW);this.vaos[i]=this.createVao(o)}if(!this.buffers)for(this.buffers=[],i=1;i<=t.utils.nextPow2(this.size);i*=2)this.buffers.push(new e.BatchBuffer(4*i*this.vertByteSize));this.vao=this.vaos[0]},c.prototype.onPrerender=function(){this.vertexCount=0},c.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&t._texture.baseTexture&&(this.sprites[this.currentIndex++]=t)},c.prototype.flush=function(){if(0!==this.currentIndex){var e,r,u,c=this.renderer.gl,p=this.MAX_TEXTURES,l=t.utils.nextPow2(this.currentIndex),h=t.utils.log2(l),f=this.buffers[h],d=this.sprites,v=this.groups,y=f.float32View,x=f.uint32View,m=0,_=null,I=1,T=0,g=v[0],w=a[d[0]._texture.baseTexture.premultipliedAlpha?1:0][d[0].blendMode];for(g.textureCount=0,g.start=0,g.blend=w,s++,u=0;u<this.currentIndex;++u){var b=d[u];e=b._texture.baseTexture;var P=a[Number(e.premultipliedAlpha)][b.blendMode];w!==P&&(w=P,r=null,T=p,s++);var j=this.getUniforms(b);_!==j&&(_=j,r=null,T=p,s++),r!==e&&(r=e,e._enabled!==s&&(T===p&&(s++,T=0,g.size=u-g.start,(g=v[I++]).textureCount=0,g.blend=w,g.start=u,g.uniforms=_),e._enabled=s,e._virtalBoundId=T,g.textures[g.textureCount++]=e,T++));var S=Math.min(b.worldAlpha,1),A=S<1&&e.premultipliedAlpha?o(b._tintRGB,S):b._tintRGB+(255*S<<24);this.fillVertices(y,x,m,b,A,e._virtalBoundId),m+=4*this.vertSize}if(g.size=u-g.start,i.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(f.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++,this.shader.attributes;var D=this.vertexBuffers[this.vertexCount]=n.createVertexBuffer(c,null,c.STREAM_DRAW);this.vaos[this.vertexCount]=this.createVao(D)}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(f.vertices,0,!1),this.vertexCount++}for(_=null,u=0;u<I;u++){var C=v[u],X=C.textureCount;C.uniforms!==_&&this.syncUniforms(C.uniforms);for(var F=0;F<X;F++){this.renderer.bindTexture(C.textures[F],F,!0);var M=this.shader.uniforms.samplerSize;M&&(M[0]=C.textures[F].realWidth,M[1]=C.textures[F].realHeight,this.shader.uniforms.samplerSize=M)}this.renderer.state.setBlendMode(C.blend),c.drawElements(c.TRIANGLES,6*C.size,c.UNSIGNED_SHORT,6*C.start*2)}this.currentIndex=0}},c.prototype.start=function(){this.renderer.bindShader(this.shader),i.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},c.prototype.stop=function(){this.flush()},c.prototype.destroy=function(){for(var t=0;t<this.vaoMax;t++)this.vertexBuffers[t]&&this.vertexBuffers[t].destroy(),this.vaos[t]&&this.vaos[t].destroy();for(this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),r.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null,t=0;t<this.buffers.length;++t)this.buffers[t].destroy()},c}(r);e.MultiTextureSpriteRenderer=c}(t.webgl||(t.webgl={}))}(pixi_projection||(pixi_projection={})),function(t){var e=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],r=[0,0,0,0],i=function(){function t(){this.surfaceID="default",this._updateID=0,this.vertexSrc="",this.fragmentSrc=""}return t.prototype.fillUniforms=function(t){},t.prototype.clear=function(){},t.prototype.boundsQuad=function(t,i,n){for(var o=i[0],a=i[1],s=i[0],u=i[1],c=2;c<8;c+=2)o>i[c]&&(o=i[c]),s<i[c]&&(s=i[c]),a>i[c+1]&&(a=i[c+1]),u<i[c+1]&&(u=i[c+1]);if(e[0].set(o,a),this.apply(e[0],e[0]),e[1].set(s,a),this.apply(e[1],e[1]),e[2].set(s,u),this.apply(e[2],e[2]),e[3].set(o,u),this.apply(e[3],e[3]),n)n.apply(e[0],e[0]),n.apply(e[1],e[1]),n.apply(e[2],e[2]),n.apply(e[3],e[3]),i[0]=e[0].x,i[1]=e[0].y,i[2]=e[1].x,i[3]=e[1].y,i[4]=e[2].x,i[5]=e[2].y,i[6]=e[3].x,i[7]=e[3].y;else{for(c=1;c<=3;c++)if(e[c].y<e[0].y||e[c].y==e[0].y&&e[c].x<e[0].x){var p=e[0];e[0]=e[c],e[c]=p}for(c=1;c<=3;c++)r[c]=Math.atan2(e[c].y-e[0].y,e[c].x-e[0].x);for(c=1;c<=3;c++)for(var l=c+1;l<=3;l++)if(r[c]>r[l]){p=e[c],e[c]=e[l],e[l]=p;var h=r[c];r[c]=r[l],r[l]=h}if(i[0]=e[0].x,i[1]=e[0].y,i[2]=e[1].x,i[3]=e[1].y,i[4]=e[2].x,i[5]=e[2].y,i[6]=e[3].x,i[7]=e[3].y,(e[3].x-e[2].x)*(e[1].y-e[2].y)-(e[1].x-e[2].x)*(e[3].y-e[2].y)<0)return i[4]=e[3].x,void(i[5]=e[3].y)}},t}();t.Surface=i}(pixi_projection||(pixi_projection={})),function(t){var e=new PIXI.Matrix,r=new PIXI.Rectangle,i=new PIXI.Point,n=function(t){function n(){var e=t.call(this)||this;return e.distortion=new PIXI.Point,e}return __extends(n,t),n.prototype.clear=function(){this.distortion.set(0,0)},n.prototype.apply=function(t,e){e=e||new PIXI.Point;var r=this.distortion,i=t.x*t.y;return e.x=t.x+r.x*i,e.y=t.y+r.y*i,e},n.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var r=t.x,i=t.y,n=this.distortion.x,o=this.distortion.y;if(0==n)e.x=r,e.y=i/(1+o*r);else if(0==o)e.y=i,e.x=r/(1+n*i);else{var a=.5*(i*n-r*o+1)/o,s=a*a+r/o;if(s<=1e-5)return void e.set(NaN,NaN);e.x=o>0?-a+Math.sqrt(s):-a-Math.sqrt(s),e.y=(r/e.x-1)/n}return e},n.prototype.mapSprite=function(t,e,i){var n=t.texture;return r.x=-t.anchor.x*n.orig.width,r.y=-t.anchor.y*n.orig.height,r.width=n.orig.width,r.height=n.orig.height,this.mapQuad(r,e,i||t.transform)},n.prototype.mapQuad=function(t,r,n){var o=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,u=(1-t.y)/t.height,c=r[0].x*(1-o)+r[1].x*o,p=r[0].y*(1-o)+r[1].y*o,l=r[0].x*(1-s)+r[1].x*s,h=r[0].y*(1-s)+r[1].y*s,f=r[3].x*(1-o)+r[2].x*o,d=r[3].y*(1-o)+r[2].y*o,v=r[3].x*(1-s)+r[2].x*s,y=r[3].y*(1-s)+r[2].y*s,x=c*(1-a)+f*a,m=p*(1-a)+d*a,_=l*(1-a)+v*a,I=h*(1-a)+y*a,T=c*(1-u)+f*u,g=p*(1-u)+d*u,w=l*(1-u)+v*u,b=h*(1-u)+y*u,P=e;return P.tx=x,P.ty=m,P.a=_-x,P.b=I-m,P.c=T-x,P.d=g-m,i.set(w,b),P.applyInverse(i,i),this.distortion.set(i.x-1,i.y-1),n.setFromMatrix(P),this},n.prototype.fillUniforms=function(t){t.distortion=t.distortion||new Float32Array([0,0,0,0]);var e=Math.abs(this.distortion.x),r=Math.abs(this.distortion.y);t.distortion[0]=1e4*e<=r?0:this.distortion.x,t.distortion[1]=1e4*r<=e?0:this.distortion.y,t.distortion[2]=1/t.distortion[0],t.distortion[3]=1/t.distortion[1]},n}(t.Surface);t.BilinearSurface=n}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i.proj=new t.ProjectionSurface(i.transform),i}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Container2s=e}(pixi_projection||(pixi_projection={})),function(t){var e=PIXI.TransformStatic.prototype.updateTransform;function r(t){var r=this.proj,i=t.proj;return i?i._surface?(r._activeProjection=i,this.updateLocalTransform(),this.localTransform.copy(this.worldTransform),void(this._parentID<0&&++this._worldID)):(e.call(this,t),void(r._activeProjection=i._activeProjection)):(e.call(this,t),void(r._activeProjection=null))}var i=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i._surface=null,i._activeProjection=null,i._currentSurfaceID=-1,i._currentLegacyID=-1,i._lastUniforms=null,i}return __extends(i,e),Object.defineProperty(i.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=r,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.TransformStatic.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"surface",{get:function(){return this._surface},set:function(t){this._surface!=t&&(this._surface=t||null,this.legacy._parentID=-1)},enumerable:!0,configurable:!0}),i.prototype.applyPartial=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e)):null!==this._surface?this.surface.apply(t,e):this.legacy.worldTransform.apply(t,e)},i.prototype.apply=function(t,e){return null!==this._activeProjection?(e=this.legacy.worldTransform.apply(t,e),this._activeProjection.surface.apply(e,e),this._activeProjection.legacy.worldTransform.apply(e,e)):null!==this._surface?(e=this.surface.apply(t,e),this.legacy.worldTransform.apply(e,e)):this.legacy.worldTransform.apply(t,e)},i.prototype.applyInverse=function(t,e){return null!==this._activeProjection?(e=this._activeProjection.legacy.worldTransform.applyInverse(t,e),this._activeProjection._surface.applyInverse(e,e),this.legacy.worldTransform.applyInverse(e,e)):null!==this._surface?(e=this.legacy.worldTransform.applyInverse(t,e),this._surface.applyInverse(e,e)):this.legacy.worldTransform.applyInverse(t,e)},i.prototype.mapBilinearSprite=function(e,r){this._surface instanceof t.BilinearSurface||(this.surface=new t.BilinearSurface),this.surface.mapSprite(e,r,this.legacy)},i.prototype.clear=function(){this.surface&&this.surface.clear()},Object.defineProperty(i.prototype,"uniforms",{get:function(){return this._currentLegacyID===this.legacy._worldID&&this._currentSurfaceID===this.surface._updateID||(this._lastUniforms=this._lastUniforms||{},this._lastUniforms.worldTransform=this.legacy.worldTransform.toArray(!0),this._surface.fillUniforms(this._lastUniforms)),this._lastUniforms},enumerable:!0,configurable:!0}),i}(t.Projection);t.ProjectionSurface=i}(pixi_projection||(pixi_projection={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=100,e.MAX_TEXTURES_LOCAL=1,e.shaderVert="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 worldTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * worldTransform * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aVertexPosition;\n    vTrans1 = aTrans1;\n    vTrans2 = aTrans2;\n    vTextureId = aTextureId;\n    vColor = aColor;\n    vFrame = aFrame;\n}\n",e.shaderFrag="precision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec2 samplerSize[%count%]; \nuniform vec4 distortion;\n\nvoid main(void){\nvec2 surface;\nvec2 surface2;\n\nfloat vx = vTextureCoord.x;\nfloat vy = vTextureCoord.y;\nfloat dx = distortion.x;\nfloat dy = distortion.y;\nfloat revx = distortion.z;\nfloat revy = distortion.w;\n\nif (distortion.x == 0.0) {\n    surface.x = vx;\n    surface.y = vy / (1.0 + dy * vx);\n    surface2 = surface;\n} else\nif (distortion.y == 0.0) {\n    surface.y = vy;\n    surface.x = vx/ (1.0 + dx * vy);\n    surface2 = surface;\n} else {\n    float c = vy * dx - vx * dy;\n    float b = (c + 1.0) * 0.5;\n    float b2 = (-c + 1.0) * 0.5;\n    float d = b * b + vx * dy;\n    if (d < -0.00001) {\n        discard;\n    }\n    d = sqrt(max(d, 0.0));\n    surface.x = (- b + d) * revy;\n    surface2.x = (- b - d) * revy;\n    surface.y = (- b2 + d) * revx;\n    surface2.y = (- b2 - d) * revx;\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * samplerSize[0];\n\nif (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n    pixels.y < vFrame.y || pixels.y > vFrame.w) {\n    uv.x = vTrans1.x * surface2.x + vTrans1.y * surface2.y + vTrans1.z;\n    uv.y = vTrans2.x * surface2.x + vTrans2.y * surface2.y + vTrans2.z;\n    pixels = uv * samplerSize[0];\n    \n    if (pixels.x < vFrame.x || pixels.x > vFrame.z ||\n        pixels.y < vFrame.y || pixels.y > vFrame.w) {\n        discard;\n    }\n}\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = 1.0; //edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec4 color;\nvec2 textureCoord = uv;\n%forloop%\ngl_FragColor = color * rColor;\n}",e.defUniforms={worldTransform:new Float32Array([1,0,0,0,1,0,0,0,1]),distortion:new Float32Array([0,0])},e}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;return this.shader,null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=14,this.vertByteSize=4*this.vertSize;var r=this.renderer.gl,i=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,r.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTrans1,r.FLOAT,!1,this.vertByteSize,8).addAttribute(t,e.aTrans2,r.FLOAT,!1,this.vertByteSize,20).addAttribute(t,e.aFrame,r.FLOAT,!1,this.vertByteSize,32).addAttribute(t,e.aColor,r.UNSIGNED_BYTE,!0,this.vertByteSize,48);return e.aTextureId&&i.addAttribute(t,e.aTextureId,r.FLOAT,!1,this.vertByteSize,52),i},e.prototype.fillVertices=function(t,e,r,i,n,o){for(var a=i.vertexData,s=i._texture,u=(s.orig.width,s.orig.height,i._anchor._x,i._anchor._y,s._frame),c=i.aTrans,p=0;p<4;p++)t[r]=a[2*p],t[r+1]=a[2*p+1],t[r+2]=c.a,t[r+3]=c.c,t[r+4]=c.tx,t[r+5]=c.b,t[r+6]=c.d,t[r+7]=c.ty,t[r+8]=u.x,t[r+9]=u.y,t[r+10]=u.x+u.width,t[r+11]=u.y+u.height,e[r+12]=n,t[r+13]=o,r+=14},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite_bilinear",e)}(pixi_projection||(pixi_projection={})),function(t){PIXI.Sprite.prototype.convertTo2s=function(){this.proj||(this.pluginName="sprite_bilinear",this.aTrans=new PIXI.Matrix,this.calculateVertices=t.Sprite2s.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices,PIXI.Container.prototype.convertTo2s.call(this))},PIXI.Container.prototype.convertTo2s=function(){this.proj||(this.proj=new t.Projection2d(this.transform),Object.defineProperty(this,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}))},PIXI.Container.prototype.convertSubtreeTo2s=function(){this.convertTo2s();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2s()}}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i.aTrans=new PIXI.Matrix,i.proj=new t.ProjectionSurface(i.transform),i.pluginName="sprite_bilinear",i}return __extends(r,e),r.prototype.calculateVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this._transformID!==t||this._textureID!==e){this._transformID=t,this._textureID=e;var r=this._texture,i=this.vertexData,n=r.trim,o=r.orig,a=this._anchor,s=0,u=0,c=0,p=0;if(n?(s=(u=n.x-a._x*o.width)+n.width,c=(p=n.y-a._y*o.height)+n.height):(s=(u=-a._x*o.width)+o.width,c=(p=-a._y*o.height)+o.height),this.proj._surface)i[0]=u,i[1]=p,i[2]=s,i[3]=p,i[4]=s,i[5]=c,i[6]=u,i[7]=c,this.proj._surface.boundsQuad(i,i);else{var l=this.transform.worldTransform,h=l.a,f=l.b,d=l.c,v=l.d,y=l.tx,x=l.ty;i[0]=h*u+d*p+y,i[1]=v*p+f*u+x,i[2]=h*s+d*p+y,i[3]=v*p+f*s+x,i[4]=h*s+d*c+y,i[5]=v*c+f*s+x,i[6]=h*u+d*c+y,i[7]=v*c+f*u+x,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(i,i)}r.transform||(r.transform=new PIXI.extras.TextureTransform(r)),r.transform.update();var m=this.aTrans;m.set(o.width,0,0,o.height,u,p),null===this.proj._surface&&m.prepend(this.transform.worldTransform),m.invert(),m.prepend(r.transform.mapCoord)}},r.prototype.calculateTrimmedVertices=function(){var t=this.transform._worldID,e=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===e)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=e;var r=this._texture,i=this.vertexTrimmedData,n=r.orig,o=this._anchor,a=-o._x*n.width,s=a+n.width,u=-o._y*n.height,c=u+n.height;if(this.proj._surface)i[0]=a,i[1]=u,i[2]=s,i[3]=u,i[4]=s,i[5]=c,i[6]=a,i[7]=c,this.proj._surface.boundsQuad(i,i,this.transform.worldTransform);else{var p=this.transform.worldTransform,l=p.a,h=p.b,f=p.c,d=p.d,v=p.tx,y=p.ty;i[0]=l*a+f*u+v,i[1]=d*u+h*a+y,i[2]=l*s+f*u+v,i[3]=d*u+h*s+y,i[4]=l*s+f*c+v,i[5]=d*c+h*s+y,i[6]=l*a+f*c+v,i[7]=d*c+h*a+y,this.proj._activeProjection&&this.proj._activeProjection.surface.boundsQuad(i,i,this.proj._activeProjection.legacy.worldTransform)}},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Sprite2s=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n){var o=e.call(this,r,i,n)||this;return o.aTrans=new PIXI.Matrix,o.proj=new t.ProjectionSurface(o.transform),o.pluginName="sprite_bilinear",o}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj},enumerable:!0,configurable:!0}),r}(PIXI.Text);t.Text2s=e,e.prototype.calculateVertices=t.Sprite2s.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2s.prototype.calculateTrimmedVertices}(pixi_projection||(pixi_projection={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=100,e.MAX_TEXTURES_LOCAL=1,e.shaderVert="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec3 aTrans1;\nattribute vec3 aTrans2;\nattribute vec4 aFrame;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 worldTransform;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * worldTransform * vec3(aVertexPosition, 1.0);\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aVertexPosition;\n    vTrans1 = aTrans1;\n    vTrans2 = aTrans2;\n    vTextureId = aTextureId;\n    vColor = aColor;\n    vFrame = aFrame;\n}\n",e.shaderFrag="precision highp float;\nvarying vec2 vTextureCoord;\nvarying vec3 vTrans1;\nvarying vec3 vTrans2;\nvarying vec4 vFrame;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nuniform sampler2D uSamplers[%count%];\nuniform vec2 samplerSize[%count%]; \nuniform vec4 params;\n\nvoid main(void){\nvec2 surface;\n\nfloat vx = vTextureCoord.x;\nfloat vy = vTextureCoord.y;\nfloat aleph = params.x;\nfloat bet = params.y;\nfloat A = params.z;\nfloat B = params.w;\n\nif (aleph == 0.0) {\n\tsurface.y = vy / (1.0 + vx * bet);\n\tsurface.x = vx;\n}\nelse if (bet == 0.0) {\n\tsurface.x = vx / (1.0 + vy * aleph);\n\tsurface.y = vy;\n} else {\n\tsurface.x = vx * (bet + 1.0) / (bet + 1.0 + vy * aleph);\n\tsurface.y = vy * (aleph + 1.0) / (aleph + 1.0 + vx * bet);\n}\n\nvec2 uv;\nuv.x = vTrans1.x * surface.x + vTrans1.y * surface.y + vTrans1.z;\nuv.y = vTrans2.x * surface.x + vTrans2.y * surface.y + vTrans2.z;\n\nvec2 pixels = uv * samplerSize[0];\n\nvec4 edge;\nedge.xy = clamp(pixels - vFrame.xy + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\nedge.zw = clamp(vFrame.zw - pixels + 0.5, vec2(0.0, 0.0), vec2(1.0, 1.0));\n\nfloat alpha = edge.x * edge.y * edge.z * edge.w;\nvec4 rColor = vColor * alpha;\n\nfloat textureId = floor(vTextureId+0.5);\nvec4 color;\nvec2 textureCoord = uv;\n%forloop%\ngl_FragColor = color * rColor;\n}",e.defUniforms={worldTransform:new Float32Array([1,0,0,0,1,0,0,0,1]),distortion:new Float32Array([0,0])},e}return __extends(e,t),e.prototype.getUniforms=function(t){var e=t.proj;return this.shader,null!==e.surface?e.uniforms:null!==e._activeProjection?e._activeProjection.uniforms:this.defUniforms},e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=14,this.vertByteSize=4*this.vertSize;var r=this.renderer.gl,i=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,r.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTrans1,r.FLOAT,!1,this.vertByteSize,8).addAttribute(t,e.aTrans2,r.FLOAT,!1,this.vertByteSize,20).addAttribute(t,e.aFrame,r.FLOAT,!1,this.vertByteSize,32).addAttribute(t,e.aColor,r.UNSIGNED_BYTE,!0,this.vertByteSize,48);return e.aTextureId&&i.addAttribute(t,e.aTextureId,r.FLOAT,!1,this.vertByteSize,52),i},e.prototype.fillVertices=function(t,e,r,i,n,o){for(var a=i.vertexData,s=i._texture,u=(s.orig.width,s.orig.height,i._anchor._x,i._anchor._y,s._frame),c=i.aTrans,p=0;p<4;p++)t[r]=a[2*p],t[r+1]=a[2*p+1],t[r+2]=c.a,t[r+3]=c.c,t[r+4]=c.tx,t[r+5]=c.b,t[r+6]=c.d,t[r+7]=c.ty,t[r+8]=u.x,t[r+9]=u.y,t[r+10]=u.x+u.width,t[r+11]=u.y+u.height,e[r+12]=n,t[r+13]=o,r+=14},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite_strange",e)}(pixi_projection||(pixi_projection={})),function(t){var e=new PIXI.Matrix,r=new PIXI.Rectangle,i=new PIXI.Point,n=function(t){function n(){var e=t.call(this)||this;return e.params=[0,0,NaN,NaN],e}return __extends(n,t),n.prototype.clear=function(){var t=this.params;t[0]=0,t[1]=0,t[2]=NaN,t[3]=NaN},n.prototype.setAxisX=function(t,e,r){var i=t.x,n=t.y,o=Math.sqrt(i*i+n*n),a=r.rotation;0!==a&&(r.skew._x-=a,r.skew._y+=a,r.rotation=0),r.skew.y=Math.atan2(n,i),this.params[2]=0!==e?-o*e:NaN,this._calc01()},n.prototype.setAxisY=function(t,e,r){var i=t.x,n=t.y,o=Math.sqrt(i*i+n*n),a=r.rotation;0!==a&&(r.skew._x-=a,r.skew._y+=a,r.rotation=0),r.skew.x=-Math.atan2(n,i)+Math.PI/2,this.params[3]=0!==e?-o*e:NaN,this._calc01()},n.prototype._calc01=function(){var t=this.params;if(isNaN(t[2]))t[1]=0,isNaN(t[3])?t[0]=0:t[0]=1/t[3];else if(isNaN(t[3]))t[0]=0,t[1]=1/t[2];else{var e=1-t[2]*t[3];t[0]=(1-t[2])/e,t[1]=(1-t[3])/e}},n.prototype.apply=function(t,e){e=e||new PIXI.Point;var r=this.params[0],i=this.params[1],n=this.params[2],o=this.params[3],a=t.x,s=t.y;if(0===r)e.y=s*(1+a*i),e.x=a;else if(0===i)e.x=a*(1+s*r),e.y=s;else{var u=n*o-s*a;e.x=n*a*(o+s)/u,e.y=o*s*(n+a)/u}return e},n.prototype.applyInverse=function(t,e){e=e||new PIXI.Point;var r=this.params[0],i=this.params[1],n=(this.params[2],this.params[3],t.x),o=t.y;return 0===r?(e.y=o/(1+n*i),e.x=n):0===i?(e.x=n*(1+o*r),e.y=o):(e.x=n*(i+1)/(i+1+o*r),e.y=o*(r+1)/(r+1+n*i)),e},n.prototype.mapSprite=function(t,e,i){var n=t.texture;return r.x=-t.anchor.x*n.orig.width,r.y=-t.anchor.y*n.orig.height,r.width=n.orig.width,r.height=n.orig.height,this.mapQuad(r,e,i||t.transform)},n.prototype.mapQuad=function(t,r,n){var o=-t.x/t.width,a=-t.y/t.height,s=(1-t.x)/t.width,u=(1-t.y)/t.height,c=r[0].x*(1-o)+r[1].x*o,p=r[0].y*(1-o)+r[1].y*o,l=r[0].x*(1-s)+r[1].x*s,h=r[0].y*(1-s)+r[1].y*s,f=r[3].x*(1-o)+r[2].x*o,d=r[3].y*(1-o)+r[2].y*o,v=r[3].x*(1-s)+r[2].x*s,y=r[3].y*(1-s)+r[2].y*s,x=c*(1-a)+f*a,m=p*(1-a)+d*a,_=l*(1-a)+v*a,I=h*(1-a)+y*a,T=c*(1-u)+f*u,g=p*(1-u)+d*u,w=l*(1-u)+v*u,b=h*(1-u)+y*u,P=e;return P.tx=x,P.ty=m,P.a=_-x,P.b=I-m,P.c=T-x,P.d=g-m,i.set(w,b),P.applyInverse(i,i),n.setFromMatrix(P),this},n.prototype.fillUniforms=function(t){var e=this.params,r=t.params||new Float32Array([0,0,0,0]);t.params=r,r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]},n}(t.Surface);t.StrangeSurface=n}(pixi_projection||(pixi_projection={})),function(t){t.container2dWorldTransform=function(){return this.proj.affine?this.transform.worldTransform:this.proj.world};var e=function(e){function r(r){var i=e.call(this,r)||this;return i.proj=new t.Projection2d(i.transform),i}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Container2d=e}(pixi_projection||(pixi_projection={})),function(t){var e,r=PIXI.Point,i=[1,0,0,0,1,0,0,0,1];!function(t){t[t.NONE=0]="NONE",t[t.FREE=1]="FREE",t[t.AXIS_X=2]="AXIS_X",t[t.AXIS_Y=3]="AXIS_Y",t[t.POINT=4]="POINT"}(e=t.AFFINE||(t.AFFINE={}));var n=function(){function t(t){this.floatArray=null,this.mat3=new Float64Array(t||i)}return Object.defineProperty(t.prototype,"a",{get:function(){return this.mat3[0]},set:function(t){this.mat3[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.mat3[1]},set:function(t){this.mat3[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this.mat3[3]},set:function(t){this.mat3[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"d",{get:function(){return this.mat3[4]},set:function(t){this.mat3[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tx",{get:function(){return this.mat3[6]},set:function(t){this.mat3[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ty",{get:function(){return this.mat3[7]},set:function(t){this.mat3[7]=t},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,r,i,n,o){var a=this.mat3;return a[0]=t,a[1]=e,a[3]=r,a[4]=i,a[6]=n,a[7]=o,this},t.prototype.toArray=function(t,e){this.floatArray||(this.floatArray=new Float32Array(9));var r=e||this.floatArray,i=this.mat3;return t?(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8]):(r[0]=i[0],r[1]=i[3],r[2]=i[6],r[3]=i[1],r[4]=i[4],r[5]=i[7],r[6]=i[2],r[7]=i[5],r[8]=i[8]),r},t.prototype.apply=function(t,e){e=e||new PIXI.Point;var r=this.mat3,i=t.x,n=t.y,o=1/(r[2]*i+r[5]*n+r[8]);return e.x=o*(r[0]*i+r[3]*n+r[6]),e.y=o*(r[1]*i+r[4]*n+r[7]),e},t.prototype.applyInverse=function(t,e){e=e||new r;var i=this.mat3,n=t.x,o=t.y,a=i[0],s=i[3],u=i[6],c=i[1],p=i[4],l=i[7],h=i[2],f=i[5],d=i[8],v=(d*p-l*f)*n+(-d*s+u*f)*o+(l*s-u*p),y=(-d*c+l*h)*n+(d*a-u*h)*o+(-l*a+u*c),x=(f*c-p*h)*n+(-f*a+s*h)*o+(p*a-s*c);return e.x=v/x,e.y=y/x,e},t.prototype.invert=function(){var t=this.mat3,e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],p=c*o-a*u,l=-c*n+a*s,h=u*n-o*s,f=e*p+r*l+i*h;return f?(f=1/f,t[0]=p*f,t[1]=(-c*r+i*u)*f,t[2]=(a*r-i*o)*f,t[3]=l*f,t[4]=(c*e-i*s)*f,t[5]=(-a*e+i*n)*f,t[6]=h*f,t[7]=(-u*e+r*s)*f,t[8]=(o*e-r*n)*f,this):this},t.prototype.identity=function(){var t=this.mat3;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},t.prototype.clone=function(){return new t(this.mat3)},t.prototype.copyTo=function(t){var e=this.mat3,r=t.mat3;return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],t},t.prototype.copy=function(t,r){var i=this.mat3,n=1/i[8],o=i[6]*n,a=i[7]*n;t.a=(i[0]-i[2]*o)*n,t.b=(i[1]-i[2]*a)*n,t.c=(i[3]-i[5]*o)*n,t.d=(i[4]-i[5]*a)*n,t.tx=o,t.ty=a,r>=2&&(r===e.POINT?(t.a=1,t.b=0,t.c=0,t.d=1):r===e.AXIS_X?(t.c=-t.b,t.d=t.a):r===e.AXIS_Y&&(t.a=t.d,t.c=-t.b))},t.prototype.copyFrom=function(t){var e=this.mat3;e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=t.c,e[4]=t.d,e[5]=0,e[6]=t.tx,e[7]=t.ty,e[8]=1},t.prototype.setToMultLegacy=function(t,e){var r=this.mat3,i=e.mat3,n=t.a,o=t.b,a=t.c,s=t.d,u=t.tx,c=t.ty,p=i[0],l=i[1],h=i[2],f=i[3],d=i[4],v=i[5],y=i[6],x=i[7],m=i[8];return r[0]=p*n+l*a+h*u,r[1]=p*o+l*s+h*c,r[2]=h,r[3]=f*n+d*a+v*u,r[4]=f*o+d*s+v*c,r[5]=v,r[6]=y*n+x*a+m*u,r[7]=y*o+x*s+m*c,r[8]=m,this},t.prototype.setToMult2d=function(t,e){var r=this.mat3,i=t.mat3,n=e.mat3,o=i[0],a=i[1],s=i[2],u=i[3],c=i[4],p=i[5],l=i[6],h=i[7],f=i[8],d=n[0],v=n[1],y=n[2],x=n[3],m=n[4],_=n[5],I=n[6],T=n[7],g=n[8];return r[0]=d*o+v*u+y*l,r[1]=d*a+v*c+y*h,r[2]=d*s+v*p+y*f,r[3]=x*o+m*u+_*l,r[4]=x*a+m*c+_*h,r[5]=x*s+m*p+_*f,r[6]=I*o+T*u+g*l,r[7]=I*a+T*c+g*h,r[8]=I*s+T*p+g*f,this},t.IDENTITY=new t,t.TEMP_MATRIX=new t,t}();t.Matrix2d=n}(pixi_projection||(pixi_projection={})),function(t){function e(t){var e=this.proj,r=this,i=t._worldID,n=r.localTransform;r._localID!==r._currentLocalID&&(n.a=r._cx*r.scale._x,n.b=r._sx*r.scale._x,n.c=r._cy*r.scale._y,n.d=r._sy*r.scale._y,n.tx=r.position._x-(r.pivot._x*n.a+r.pivot._y*n.c),n.ty=r.position._y-(r.pivot._x*n.b+r.pivot._y*n.d),r._currentLocalID=r._localID,e._currentProjID=-1);var o=e._projID;if(e._currentProjID!==o&&(e._currentProjID=o,0!==o?e.local.setToMultLegacy(n,e.matrix):e.local.copyFrom(n),r._parentID=-1),r._parentID!==i){var a=t.proj;a&&!a.affine?e.world.setToMult2d(a.world,e.local):e.world.setToMultLegacy(t.worldTransform,e.local),e.world.copy(r.worldTransform,e._affine),r._parentID=i,r._worldID++}}var r=new PIXI.Point,i=[new PIXI.Point,new PIXI.Point,new PIXI.Point,new PIXI.Point],n=new PIXI.Rectangle,o=new t.Matrix2d,a=function(a){function s(e,r){var i=a.call(this,e,r)||this;return i.matrix=new t.Matrix2d,i.local=new t.Matrix2d,i.world=new t.Matrix2d,i._projID=0,i._currentProjID=-1,i._affine=t.AFFINE.NONE,i}return __extends(s,a),Object.defineProperty(s.prototype,"affine",{get:function(){return this._affine},set:function(t){this._affine!=t&&(this._affine=t,this._currentProjID=-1)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"enabled",{set:function(t){t!==this._enabled&&(this._enabled=t,t?(this.legacy.updateTransform=e,this.legacy._parentID=-1):(this.legacy.updateTransform=PIXI.TransformStatic.prototype.updateTransform,this.legacy._parentID=-1))},enumerable:!0,configurable:!0}),s.prototype.setAxisX=function(t,e){void 0===e&&(e=1);var r=t.x,i=t.y,n=Math.sqrt(r*r+i*i),o=this.matrix.mat3;o[0]=r/n,o[1]=i/n,o[2]=e/n,this._projID++},s.prototype.setAxisY=function(t,e){void 0===e&&(e=1);var r=t.x,i=t.y,n=Math.sqrt(r*r+i*i),o=this.matrix.mat3;o[3]=r/n,o[4]=i/n,o[5]=e/n,this._projID++},s.prototype.mapSprite=function(t,e){var r=t.texture;return n.x=-t.anchor.x*r.orig.width,n.y=-t.anchor.y*r.orig.height,n.width=r.orig.width,n.height=r.orig.height,this.mapQuad(n,e)},s.prototype.mapQuad=function(e,n){i[0].set(e.x,e.y),i[1].set(e.x+e.width,e.y),i[2].set(e.x+e.width,e.y+e.height),i[3].set(e.x,e.y+e.height);var a=1,s=2,u=3;if(0!==t.utils.getIntersectionFactor(n[0],n[2],n[1],n[3],r)){a=1,s=3,u=2;var c=Math.sqrt((n[0].x-r.x)*(n[0].x-r.x)+(n[0].y-r.y)*(n[0].y-r.y)),p=Math.sqrt((n[a].x-r.x)*(n[a].x-r.x)+(n[a].y-r.y)*(n[a].y-r.y)),l=Math.sqrt((n[s].x-r.x)*(n[s].x-r.x)+(n[s].y-r.y)*(n[s].y-r.y)),h=Math.sqrt((n[u].x-r.x)*(n[u].x-r.x)+(n[u].y-r.y)*(n[u].y-r.y)),f=(c+h)/h,d=(p+l)/l,v=(p+l)/p,y=this.matrix.mat3;y[0]=i[0].x*f,y[1]=i[0].y*f,y[2]=f,y[3]=i[a].x*d,y[4]=i[a].y*d,y[5]=d,y[6]=i[s].x*v,y[7]=i[s].y*v,y[8]=v,this.matrix.invert(),(y=o.mat3)[0]=n[0].x,y[1]=n[0].y,y[2]=1,y[3]=n[a].x,y[4]=n[a].y,y[5]=1,y[6]=n[s].x,y[7]=n[s].y,y[8]=1,this.matrix.setToMult2d(o,this.matrix),this._projID++}},s.prototype.clear=function(){this._currentProjID=-1,this._projID=0,this.matrix.identity()},s}(t.Projection);t.Projection2d=a}(pixi_projection||(pixi_projection={})),function(t){PIXI.Sprite.prototype.convertTo2d=function(){this.proj||(this.calculateVertices=t.Sprite2d.prototype.calculateVertices,this.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices,this.proj=new t.Projection2d(this.transform),this.pluginName="sprite2d",this.vertexData=new Float32Array(12),Object.defineProperty(this,"worldTransform",{get:t.container2dWorldTransform,enumerable:!0,configurable:!0}))},PIXI.Container.prototype.convertTo2d=function(){this.proj||(this.proj=new t.Projection2d(this.transform),this.pluginName="sprite2d",Object.defineProperty(this,"worldTransform",{get:t.container2dWorldTransform,enumerable:!0,configurable:!0}))},PIXI.Container.prototype.convertSubtreeTo2d=function(){this.convertTo2d();for(var t=0;t<this.children.length;t++)this.children[t].convertSubtreeTo2d()}}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i.proj=new t.Projection2d(i.transform),i.pluginName="sprite2d",i.vertexData=new Float32Array(12),i}return __extends(r,e),r.prototype.calculateVertices=function(){if(this.proj._affine)return 8!=this.vertexData.length&&(this.vertexData=new Float32Array(8)),void e.prototype.calculateVertices.call(this);12!=this.vertexData.length&&(this.vertexData=new Float32Array(12));var t=this.transform._worldID,r=this._texture._updateID;if(this._transformID!==t||this._textureID!==r){this._transformID=t,this._textureID=r;var i=this._texture,n=this.proj.world.mat3,o=this.vertexData,a=i.trim,s=i.orig,u=this._anchor,c=0,p=0,l=0,h=0;a?(c=(p=a.x-u._x*s.width)+a.width,l=(h=a.y-u._y*s.height)+a.height):(c=(p=-u._x*s.width)+s.width,l=(h=-u._y*s.height)+s.height),o[0]=n[0]*p+n[3]*h+n[6],o[1]=n[1]*p+n[4]*h+n[7],o[2]=n[2]*p+n[5]*h+n[8],o[3]=n[0]*c+n[3]*h+n[6],o[4]=n[1]*c+n[4]*h+n[7],o[5]=n[2]*c+n[5]*h+n[8],o[6]=n[0]*c+n[3]*l+n[6],o[7]=n[1]*c+n[4]*l+n[7],o[8]=n[2]*c+n[5]*l+n[8],o[9]=n[0]*p+n[3]*l+n[6],o[10]=n[1]*p+n[4]*l+n[7],o[11]=n[2]*p+n[5]*l+n[8]}},r.prototype.calculateTrimmedVertices=function(){if(this.proj._affine)e.prototype.calculateTrimmedVertices.call(this);else{var t=this.transform._worldID,r=this._texture._updateID;if(this.vertexTrimmedData){if(this._transformTrimmedID===t&&this._textureTrimmedID===r)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=t,this._textureTrimmedID=r;var i=this._texture,n=this.vertexTrimmedData,o=i.orig,a=this._anchor,s=this.proj.world.mat3,u=-a._x*o.width,c=u+o.width,p=-a._y*o.height,l=p+o.height,h=1/(s[2]*u+s[5]*p+s[8]);n[0]=h*(s[0]*u+s[3]*p+s[6]),n[1]=h*(s[1]*u+s[4]*p+s[7]),h=1/(s[2]*c+s[5]*p+s[8]),n[2]=h*(s[0]*c+s[3]*p+s[6]),n[3]=h*(s[1]*c+s[4]*p+s[7]),h=1/(s[2]*c+s[5]*l+s[8]),n[4]=h*(s[0]*c+s[3]*l+s[6]),n[5]=h*(s[1]*c+s[4]*l+s[7]),h=1/(s[2]*u+s[5]*l+s[8]),n[6]=h*(s[0]*u+s[3]*l+s[6]),n[7]=h*(s[1]*u+s[4]*l+s[7])}},Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r}(PIXI.Sprite);t.Sprite2d=e}(pixi_projection||(pixi_projection={})),function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shaderVert="precision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position.xyw = projectionMatrix * aVertexPosition;\n    gl_Position.z = 0.0;\n    \n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",e.shaderFrag="\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\nvec4 color;\nvec2 textureCoord = vTextureCoord;\nfloat textureId = floor(vTextureId+0.5);\n%forloop%\ngl_FragColor = color * vColor;\n}",e}return __extends(e,t),e.prototype.createVao=function(t){var e=this.shader.attributes;this.vertSize=6,this.vertByteSize=4*this.vertSize;var r=this.renderer.gl,i=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(t,e.aVertexPosition,r.FLOAT,!1,this.vertByteSize,0).addAttribute(t,e.aTextureCoord,r.UNSIGNED_SHORT,!0,this.vertByteSize,12).addAttribute(t,e.aColor,r.UNSIGNED_BYTE,!0,this.vertByteSize,16);return e.aTextureId&&i.addAttribute(t,e.aTextureId,r.FLOAT,!1,this.vertByteSize,20),i},e.prototype.fillVertices=function(t,e,r,i,n,o){var a=i.vertexData,s=i._texture._uvs.uvsUint32;if(8===a.length)if(this.renderer.roundPixels){var u=this.renderer.resolution;t[r]=(a[0]*u|0)/u,t[r+1]=(a[1]*u|0)/u,t[r+2]=1,t[r+6]=(a[2]*u|0)/u,t[r+7]=(a[3]*u|0)/u,t[r+8]=1,t[r+12]=(a[4]*u|0)/u,t[r+13]=(a[5]*u|0)/u,t[r+14]=1,t[r+18]=(a[6]*u|0)/u,t[r+19]=(a[7]*u|0)/u,t[r+20]=1}else t[r]=a[0],t[r+1]=a[1],t[r+2]=1,t[r+6]=a[2],t[r+7]=a[3],t[r+8]=1,t[r+12]=a[4],t[r+13]=a[5],t[r+14]=1,t[r+18]=a[6],t[r+19]=a[7],t[r+20]=1;else t[r]=a[0],t[r+1]=a[1],t[r+2]=a[2],t[r+6]=a[3],t[r+7]=a[4],t[r+8]=a[5],t[r+12]=a[6],t[r+13]=a[7],t[r+14]=a[8],t[r+18]=a[9],t[r+19]=a[10],t[r+20]=a[11];e[r+3]=s[0],e[r+9]=s[1],e[r+15]=s[2],e[r+21]=s[3],e[r+4]=e[r+10]=e[r+16]=e[r+22]=n,t[r+5]=t[r+11]=t[r+17]=t[r+23]=o},e}(t.webgl.MultiTextureSpriteRenderer);PIXI.WebGLRenderer.registerPlugin("sprite2d",e)}(pixi_projection||(pixi_projection={})),function(t){var e=function(e){function r(r,i,n){var o=e.call(this,r,i,n)||this;return o.proj=new t.Projection2d(o.transform),o.pluginName="sprite2d",o.vertexData=new Float32Array(12),o}return __extends(r,e),Object.defineProperty(r.prototype,"worldTransform",{get:function(){return this.proj.affine?this.transform.worldTransform:this.proj.world},enumerable:!0,configurable:!0}),r}(PIXI.Text);t.Text2d=e,e.prototype.calculateVertices=t.Sprite2d.prototype.calculateVertices,e.prototype.calculateTrimmedVertices=t.Sprite2d.prototype.calculateTrimmedVertices}(pixi_projection||(pixi_projection={})),function(t){var e;(e=t.utils||(t.utils={})).createIndicesForQuads=function(t){for(var e=6*t,r=new Uint16Array(e),i=0,n=0;i<e;i+=6,n+=4)r[i+0]=n+0,r[i+1]=n+1,r[i+2]=n+2,r[i+3]=n+0,r[i+4]=n+2,r[i+5]=n+3;return r},e.isPow2=function(t){return!(t&t-1||!t)},e.nextPow2=function(t){return t+=+(0===t),--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},e.log2=function(t){var e,r;return e=+(t>65535)<<4,e|=r=+((t>>>=e)>255)<<3,e|=r=+((t>>>=r)>15)<<2,(e|=r=+((t>>>=r)>3)<<1)|(t>>>=r)>>1},e.getIntersectionFactor=function(t,e,r,i,n){var o=e.x-t.x,a=r.x-i.x,s=r.x-t.x,u=e.y-t.y,c=r.y-i.y,p=r.y-t.y,l=o*c-u*a;if(Math.abs(l)<1e-7)return n.x=o,n.y=u,0;var h=(s*c-p*a)/l,f=(o*p-u*s)/l;return f<1e-6||f-1>-1e-6?-1:(n.x=t.x+h*(e.x-t.x),n.y=t.y+h*(e.y-t.y),1)},e.getPositionFromQuad=function(t,e,r){r=r||new PIXI.Point;var i=1-e.x,n=1-i,o=1-e.y,a=1-o;return r.x=(t[0].x*i+t[1].x*n)*o+(t[3].x*i+t[2].x*n)*a,r.y=(t[0].y*i+t[1].y*n)*o+(t[3].y*i+t[2].y*n)*a,r}}(pixi_projection||(pixi_projection={})),PIXI.projection=pixi_projection;